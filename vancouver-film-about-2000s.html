<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>~*~ Vancouver Film Dept - Resource Hub ~*~</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@700&family=VT323&display=swap" rel="stylesheet">
    <style>
        /* --- Core Styles --- */
        body {
            background-color: #1a1a2e; 
            color: #e0e0e0;
            font-family: 'VT323', 'Courier New', monospace;
            font-size: 20px;
            line-height: 1.6;
            margin: 0;
            padding: 0;
        }
        #main-container {
            width: 95%;
            max-width: 900px;
            margin: 40px auto;
            background: rgba(26, 26, 46, 0.8);
            border: 2px solid #4a4a68;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
        }

        /* --- Header --- */
        h1 {
            color: #ffffff; text-align: center; font-family: 'Poppins', sans-serif;
            font-size: 48px; text-shadow: 0 0 5px rgba(135, 206, 235, 0.5), 0 0 10px rgba(135, 206, 235, 0.5);
            letter-spacing: 3px; font-weight: 700; margin-bottom: 15px; text-transform: uppercase;
        }
        .ticker-wrap {
            width: 100%; overflow: hidden; background-color: #87ceeb;
            padding: 10px 0; box-sizing: border-box;
        }
        .ticker {
            display: inline-block; white-space: nowrap; padding-left: 100%;
            box-sizing: border-box; animation: ticker-scroll 20s linear infinite;
            color: #1a1a2e; font-weight: bold; font-size: 22px;
        }
        @keyframes ticker-scroll {
            0%   { transform: translateX(0); }
            100% { transform: translateX(-100%); }
        }

        /* --- Main Navigation --- */
        #main-nav {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
            margin: 25px 0;
        }
        .nav-btn {
            padding: 10px 20px;
            border: 2px solid #9370db;
            background-color: transparent;
            color: #e0e0e0;
            font-family: 'Poppins', sans-serif;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            border-radius: 5px;
            text-decoration: none;
            display: inline-block;
        }
        .nav-btn:hover, .nav-btn.active {
            background-color: #9370db;
            color: #1a1a2e;
        }
        
        /* --- Page Views --- */
        .page-view { display: none; }
        .page-view.active { display: block; }
        
        /* --- Filter Dropdown --- */
        #filter-container {
            display: flex; justify-content: center; align-items: center; gap: 15px;
            margin-bottom: 30px; padding-bottom: 20px; border-bottom: 2px dashed #4a4a68;
        }
        #filter-container label { font-size: 22px; color: #9370db; }
        #filter-dropdown {
            background-color: #1a1a2e; color: #e0e0e0; border: 2px solid #9370db;
            padding: 8px; font-family: 'VT323', monospace; font-size: 18px; border-radius: 4px;
        }
        #filter-dropdown:focus { outline: 2px solid #87ceeb; }

        /* --- Resource Section --- */
        .resource-section { display: block; }
        .resource-section.hidden { display: none; }
        h2 {
            color: #87ceeb; font-family: Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif;
            letter-spacing: 2px; border-bottom: 3px solid #4a4a68;
            padding-bottom: 8px; margin-top: 40px;
        }
        ul { list-style-type: none; padding-left: 20px; }
        li { padding-bottom: 12px; position: relative; padding-left: 25px; }
        li::before { content: '>>'; position: absolute; left: 0; top: 0; color: #9370db; }
        a {
            color: #87ceeb; text-decoration: none; font-weight: bold;
            border-bottom: 1px dotted #87ceeb; transition: all 0.2s ease-in-out;
        }
        li a:hover {
            color: #1a1a2e; background-color: #87ceeb; text-shadow: none;
            border-bottom: 1px dotted transparent;
        }
        
        /* --- News Section --- */
        .news-article {
            border-bottom: 1px solid #4a4a68; padding: 15px 5px; margin-bottom: 15px;
        }
        .news-article:last-child { border-bottom: none; }
        .news-title {
            color: #ffffff; font-size: 24px; margin: 0 0 5px 0; font-family: 'Poppins', sans-serif;
        }
        .news-meta { font-size: 16px; color: #9370db; margin-bottom: 10px; }
        .news-snippet { font-size: 18px; color: #e0e0e0; line-height: 1.5; }

        /* --- Message Board Section --- */
        #message-form { display: flex; flex-direction: column; gap: 15px; margin-top: 20px; }
        .form-group { display: flex; flex-direction: column; }
        #message-form label { font-size: 18px; color: #9370db; margin-bottom: 5px; }
        #message-form input, #message-form textarea {
            background-color: rgba(0, 0, 0, 0.2); border: 1px solid #4a4a68;
            color: #e0e0e0; padding: 10px; font-family: 'VT323', monospace;
            font-size: 18px; border-radius: 4px;
        }
        #message-form textarea { resize: vertical; min-height: 80px; }
        #message-form button {
            align-self: flex-start; padding: 10px 20px; border: 2px solid #87ceeb;
            background-color: transparent; color: #87ceeb; font-size: 18px;
            cursor: pointer; transition: all 0.2s ease-in-out;
        }
        #message-form button:hover { background-color: #87ceeb; color: #1a1a2e; }
        #messages-container { margin-top: 30px; }
        .message-item {
            background-color: rgba(0, 0, 0, 0.1); border: 1px dashed #4a4a68;
            padding: 15px; margin-bottom: 15px; border-radius: 5px;
        }
        .message-header { display: flex; justify-content: space-between; align-items: center; }
        .message-name { font-weight: bold; color: #87ceeb; font-size: 22px; }
        .message-time { font-size: 14px; color: #9370db; }
        .message-text { margin-top: 10px; color: #e0e0e0; white-space: pre-wrap; word-wrap: break-word;}

        /* --- Footer & Flair --- */
        hr {
            border: 0; height: 30px; background-image: url('https://web.archive.org/web/20091027181055if_/http://geocities.com/hollywood/set/7338/flamingtextbar.gif');
            background-repeat: repeat-x; margin: 40px 0; opacity: 0.7;
        }
        .center-text { text-align: center; }
        #footer {
            margin-top: 30px; font-size: 16px; color: #a0a0a0;
            border-top: 1px solid #4a4a68; padding-top: 20px;
        }

        /* --- Responsive Design --- */
        @media (max-width: 768px) {
            h1 { font-size: 36px; }
            #main-container { padding: 20px 15px; }
            #filter-container { flex-direction: column; }
        }
    </style>
</head>
<body>

    <div id="main-container">
        <!-- Static Header -->
        <div class="center-text">
            <img src="https://web.archive.org/web/20090831182211if_/http://www.geocities.com/hollywood/casting/2005/camera.gif" alt="Animated Camera" width="100">
        </div>
        <h1>Vancouver Film Dept</h1>
        
        <!-- Main Navigation -->
        <nav id="main-nav">
            <button class="nav-btn active" data-view="hub-view">Resource Hub</button>
            <button class="nav-btn" data-view="news-view">News</button>
            <a href="https://www.creativebc.com/services/provincial-film-commission/in-production/" target="_blank" class="nav-btn">In Production</a>
            <button class="nav-btn" data-view="board-view">Message Board</button>
        </nav>

        <div class="ticker-wrap">
            <div class="ticker">**!! YOUR GUIDE TO THE VANCOUVER FILM DEPARTMENT !!** LEAVE A MESSAGE ON THE BOARD! !!**</div>
        </div>
        <hr>

        <!-- Dynamic Content Area -->
        <div id="hub-view" class="page-view active">
            <div id="filter-container">
                <label for="filter-dropdown">Filter by Department:</label>
                <select id="filter-dropdown"></select>
            </div>
            <div id="section-container"></div>
        </div>
        
        <div id="news-view" class="page-view">
            <h2>Latest Industry News</h2>
            <div id="news-container"></div>
        </div>
        
        <div id="board-view" class="page-view">
            <h2>Message Board</h2>
            <p>Leave a shout-out, ask a question, or post a gig. Keep it professional!</p>
            <form id="message-form">
                <div class="form-group">
                    <label for="name-input">Your Name:</label>
                    <input type="text" id="name-input" required maxlength="50">
                </div>
                <div class="form-group">
                    <label for="message-input">Your Message:</label>
                    <textarea id="message-input" required maxlength="500"></textarea>
                </div>
                <button type="submit">Post Message</button>
            </form>
            <div id="messages-container">
                <p>Loading messages...</p>
            </div>
        </div>

        <!-- Static Footer -->
        <hr>
        <div id="footer" class="center-text">
             <p>This page was last updated on: June 11, 2025</p>
             <p>!!! THANKS 4 VISITING !!!</p>
        </div>
    </div>

<script type="module">
    // Import Firebase modules
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getAuth, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
    import { getFirestore, collection, addDoc, onSnapshot, serverTimestamp, query, orderBy } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

    // --- DATABASES ---
    const resources = [
        { id: 'iatse-891', name: 'IATSE 891', category: 'Unions & Guilds', url: 'https://www.iatse.com/', description: 'Represents motion picture technicians, artists, and craftspersons...' },
        { id: 'iatse-669', name: 'IATSE 669', category: 'Unions & Guilds', url: 'https://www.icg669.com/', description: 'The International Cinematographers Guild for Western Canada...' },
        { id: 'dgc-bc', name: 'DGC BC', category: 'Unions & Guilds', url: 'https://www.dgc.ca/en/british-columbia/', description: 'The Directors Guild of Canada, BC District Council...' },
        { id: 'ubcp-actra', name: 'UBCP / ACTRA', category: 'Unions & Guilds', url: 'https://www.ubcpactra.ca/', description: 'The Union of BC Performers, a branch of ACTRA...' },
        { id: 'teamsters-155', name: 'Teamsters 155', category: 'Unions & Guilds', url: 'https://www.teamsters155.org/', description: 'Represents workers in transportation, security, catering...' },
        { id: 'whites', name: 'William F. White', category: 'Rentals', url: 'https://www.whites.com/', description: 'The largest and most comprehensive rental house in Canada...' },
        { id: 'sim-camera', name: 'Sim Camera', category: 'Rentals', url: 'https://www.siminternational.com/', description: 'A major rental house specializing in high-end digital cameras...' },
        { id: 'panavision-yvr', name: 'Panavision Vancouver', category: 'Rentals', url: 'https://www.panavision.com/', description: 'The Vancouver branch of the world-renowned camera and lens company...' },
        { id: 'keslow-camera', name: 'Keslow Camera', category: 'Rentals', url: 'https://keslowcamera.com/', description: 'A top-tier camera rental house...' },
        { id: 'vfs-studios', name: 'Vancouver Film Studios', category: 'Studios', url: 'https://vancouverfilmstudios.com/', description: 'One of the largest production facilities in North America...' },
        { id: 'bridge-studios', name: 'Bridge Studios', category: 'Studios', url: 'https://bridgestudios.com/', description: 'An iconic studio complex in Burnaby...' },
        { id: 'trisko-talent', name: 'Trisko Talent', category: 'Casting', url: 'https://www.triskotalent.com/', description: 'A well-established talent agency...' },
        { id: 'lucas-talent', name: 'Lucas Talent', category: 'Casting', url: 'https://www.lucastalent.com/', description: 'A premier literary and talent agency...' },
        { id: 'showbiz-management', name: 'Showbiz Management', category: 'Casting', url: 'https://showbizmanagement.com/', description: 'A leading agency specializing in background performers...' },
        { id: 'super-props', name: 'Super Props', category: 'Props & Set Dec', url: 'http://superprops.ca/', description: 'A large prop house specializing in hospital/medical props...' },
        { id: 'antique-alley', name: 'Antique Alley', category: 'Props & Set Dec', url: 'https://antiquealleymovieprops.com/', description: 'A prop house focused on antiques and vintage items...' },
        { id: 'hollynorth', name: 'HollyNorth Supplies', category: 'Expendables', url: 'https://hollynorth.com/', description: 'A comprehensive one-stop-shop for all production supplies...' },
        { id: 'matrix-productions', name: 'Matrix Productions', category: 'Expendables', url: 'https://www.matrixproductionservices.com/', description: 'Provides a wide range of expendables and location equipment...' },
        { id: 'creative-bc', name: 'Creative BC', category: 'Industry Orgs', url: 'https://www.creativebc.com/', description: 'An independent non-profit that supports and promotes BC\'s creative industries...' }
    ];
    const newsArticles = [
        { title: 'New "Deadpool" Movie Wraps Filming in Vancouver', source: 'Variety', date: '2025-06-10', snippet: 'After months of shooting across the Lower Mainland, the highly anticipated superhero sequel has officially wrapped...', url: '#' },
        { title: 'Creative BC Announces New Fund for Indigenous Filmmakers', source: 'The Hollywood Reporter', date: '2025-06-08', snippet: 'A new multi-million dollar fund aims to support and elevate storytelling from Indigenous creators...', url: '#' },
        { title: 'Vancouver Animation Industry Sees Record Growth in 2025', source: 'Animation Magazine', date: '2025-06-05', snippet: 'Fueled by demand from streaming services, local animation studios are on a hiring spree...', url: '#' }
    ];

    // --- DOM ELEMENTS ---
    const sectionContainer = document.getElementById('section-container');
    const filterDropdown = document.getElementById('filter-dropdown');
    const newsContainer = document.getElementById('news-container');
    const mainNav = document.getElementById('main-nav');
    const pageViews = document.querySelectorAll('.page-view');
    const messageForm = document.getElementById('message-form');
    const messagesContainer = document.getElementById('messages-container');
    const nameInput = document.getElementById('name-input');
    const messageInput = document.getElementById('message-input');
    
    // --- FIREBASE SETUP ---
    // These variables are provided by the environment.
    const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
    const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
    
    let db, auth, messagesCollection;

    async function initializeFirebase() {
        if (Object.keys(firebaseConfig).length === 0) {
            console.error("Firebase config is not available.");
            messagesContainer.innerHTML = "<p>Message Board is currently unavailable.</p>";
            return;
        }
        
        try {
            const app = initializeApp(firebaseConfig);
            db = getFirestore(app);
            auth = getAuth(app);
            
            // Define the collection path
            messagesCollection = collection(db, 'artifacts', appId, 'public/data/messages');
            
            // Authenticate the user
            if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                 await signInWithCustomToken(auth, __initial_auth_token);
            } else {
                 await signInAnonymously(auth);
            }
            
            console.log("Firebase initialized and user authenticated.");
            listenForMessages();
            setupMessageForm();

        } catch (error) {
            console.error("Error initializing Firebase:", error);
            messagesContainer.innerHTML = "<p>Error connecting to the Message Board.</p>";
        }
    }


    // --- RENDER FUNCTIONS ---
    function renderSections() {
        const groupedResources = resources.reduce((acc, r) => { (acc[r.category] = acc[r.category] || []).push(r); return acc; }, {});
        sectionContainer.innerHTML = Object.keys(groupedResources).map(cat => `
            <div class="resource-section" data-category="${cat}">
                <h2>${cat}</h2>
                <ul>${groupedResources[cat].map(r => `<li><a href="${r.url}" target="_blank">${r.name}</a> - ${r.description}</li>`).join('')}</ul>
            </div>`).join('');
    }

    function renderNews() {
        newsContainer.innerHTML = newsArticles.map(a => `
            <div class="news-article">
                <h3 class="news-title"><a href="${a.url}" target="_blank">${a.title}</a></h3>
                <div class="news-meta">Source: ${a.source} | Published: ${a.date}</div>
                <p class="news-snippet">${a.snippet}</p>
            </div>`).join('');
    }

    // --- EVENT LISTENERS & SETUP ---
    function setupFilter() {
        const categories = ['All', ...new Set(resources.map(r => r.category))];
        filterDropdown.innerHTML = categories.map(cat => `<option value="${cat}">${cat}</option>`).join('');
        filterDropdown.addEventListener('change', e => {
            const selected = e.target.value;
            document.querySelectorAll('.resource-section').forEach(s => s.classList.toggle('hidden', !(selected === 'All' || s.dataset.category === selected)));
        });
    }

    function setupNavigation() {
        mainNav.addEventListener('click', e => {
            if (e.target.tagName === 'BUTTON') {
                const viewId = e.target.dataset.view;
                mainNav.querySelectorAll('button.nav-btn').forEach(b => b.classList.remove('active'));
                e.target.classList.add('active');
                pageViews.forEach(v => v.classList.toggle('active', v.id === viewId));
            }
        });
    }

    function setupMessageForm() {
        messageForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const name = nameInput.value.trim();
            const text = messageInput.value.trim();
            
            if (name && text && auth.currentUser) {
                try {
                    await addDoc(messagesCollection, {
                        name: name,
                        text: text,
                        timestamp: serverTimestamp()
                    });
                    messageInput.value = ''; // Clear message field on successful post
                    messageInput.focus();
                } catch (error) {
                    console.error("Error adding document: ", error);
                    alert("Could not post message. Please try again.");
                }
            }
        });
    }

    function listenForMessages() {
        if (!messagesCollection) return;
        
        // Using orderBy requires a composite index in Firestore. For simplicity,
        // we will fetch and sort on the client, which is fine for small-scale apps.
        // For larger apps, creating the index is recommended.
        const q = query(collection(db, 'artifacts', appId, 'public/data/messages'));
        onSnapshot(q, (snapshot) => {
            const messages = [];
            snapshot.forEach((doc) => {
                messages.push({ ...doc.data(), id: doc.id });
            });
            
            // Sort messages by timestamp, newest first.
            messages.sort((a, b) => (b.timestamp?.seconds || 0) - (a.timestamp?.seconds || 0));

            if (messages.length === 0) {
                messagesContainer.innerHTML = '<p>No messages yet. Be the first!</p>';
                return;
            }
            
            messagesContainer.innerHTML = messages.map(msg => `
                <div class="message-item">
                    <div class="message-header">
                        <span class="message-name">${msg.name || 'Anonymous'}</span>
                        <span class="message-time">${msg.timestamp ? new Date(msg.timestamp.seconds * 1000).toLocaleString() : 'Just now'}</span>
                    </div>
                    <p class="message-text">${msg.text || ''}</p>
                </div>
            `).join('');
        }, (error) => {
            console.error("Error fetching messages: ", error);
            messagesContainer.innerHTML = "<p>Could not load messages.</p>";
        });
    }
    
    // --- INITIALIZATION ---
    function init() {
        renderSections();
        setupFilter();
        renderNews();
        setupNavigation();
        initializeFirebase();
    }

    init();
</script>
</body>
</html>
